!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Jcalendar=t()}(this,function(){function e(e){return e<10?"0"+e:e}function t(){var e=document.getElementsByClassName("Jcalendar-wrapper")[0],t=document.getElementsByClassName("Jcalendar-bg")[0];if("object"==typeof e){e.style.bottom="-100%";var r=setTimeout(function(){e.parentNode.removeChild(e),clearTimeout(r)},300)}if("object"==typeof t){t.style.opacity="0";var n=setTimeout(function(){t.parentNode.removeChild(t),clearTimeout(n)},300)}}function r(e){var t=new Date,r=t.getFullYear(),n=t.getMonth()+1,a=t.getDate(),c=t.getHours(),s=t.getMinutes(),u=t.getSeconds(),i=[],o=[],l=/^[0-9]{3}[1-9]\-[0-9][1-9]\-[0-9][1-9]$/;return/^[0-9]{3}[1-9]\-[0-9][1-9]\-[0-9][1-9] ([0-1][1-9]|2[0-3])\:[0-5][0-9]\:[0-5][0-9]$/.test(e)?(r=(i=/[0-9]{3}[1-9]\-[0-9][1-9]\-[0-9][1-9]/.exec(e)[0].split("-"))[0],n=i[1],a=i[2],c=(o=/([0-1][1-9]|2[0-3])\:[0-5][0-9]\:[0-5][0-9]/.exec(e)[0].split(":"))[0],s=o[1],u=o[2]):l.test(e)&&(r=(i=/[0-9]{3}[1-9]\-[0-9][1-9]\-[0-9][1-9]/.exec(e)[0].split("-"))[0],n=i[1],a=i[2]),{currentYear:parseInt(r),currentMonth:parseInt(n),currentDay:parseInt(a),currentHour:parseInt(c),currentMinute:parseInt(s),currentSecond:parseInt(u)}}function n(e,t,r){var n=[],a=new Date;!e|!t|!r&&(e=a.getFullYear(),t=a.getMonth()+1,r=a.getDate());for(var c=new Date(e,t-1,1),s=c.getDay(),u=new Date(e,t,0).getDate(),i=new Date(e,t-1,0).getDate(),o=0;o<s;o++){var l="disabled",d=i-s+o+1;0===(m=t-1)&&(m=1),n.push({date:d,showDate:d,thisMonth:m,className:l})}for(o=0;o<u;o++){var l="available",m=t;(d=o+1)===parseInt(r)&&(l="available current"),n.push({date:d,showDate:d,thisMonth:m,className:l})}for(var p=n.length,o=0;o<42-p;o++){var l="disabled",d=o+1;13===(m=t+1)&&(m=12),n.push({date:d,showDate:d,thisMonth:m,className:l})}return{year:c.getFullYear(),month:c.getMonth()+1,days:n}}function a(e){this.inputDom=document.getElementById(e.input),this.currentYear="",this.currentMonth="",this.currentDay="",this.currentHour=0,this.currentMinute=0,this.currentSecond=0,this.timeSelector=!1,this.startYear=1970,this.title="请选择",e.title&&"string"==typeof e.title&&(this.title=e.title),e.timeSelector&&"boolean"==typeof e.timeSelector&&(this.timeSelector=e.timeSelector),console.log(this.type),this.init()}return a.prototype={constructor:a,init:function(){this.inputBindEvent()},render:function(t,r,a,c,s,u,i){var o=n(t,r,a),t=o.year,r=o.month,l=o.days;this.currentYear=t,this.currentMonth=r,this.currentDay=a,this.currentHour=c,this.currentMinute=s,this.currentSecond=u;var d="";l.forEach(function(e,t){t%7==0&&(d+="<tr>"),d+="<td class='"+e.className+"'>"+e.showDate+"</td>",t%7==6&&(d+="</tr>")});var m="<div class='Jcalendar-date-wrapper'><div class='Jcalendar-date-header'><a class='Jcalendar-prev-year' href='javascript:void(0);'>&lt;&lt;</a><a class='Jcalendar-prev-month' href='javascript:void(0);'>&lt;</a><span class='Jcalendar-year'> "+this.currentYear+"年</span><span class='Jcalendar-month'>"+e(this.currentMonth)+"月 </span><a class='Jcalendar-next-year' href='javascript:void(0);'>&gt;&gt;</a><a class='Jcalendar-next-month' href='javascript:void(0);'>&gt;</a></div><table class='Jcalendar-date-table'><thead><tr><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr></thead><tbody>"+d+"</tbody></table></div>",p=this.timeSelector?"<div class='Jcalendar-time-wrapper'><table class='Jcalendar-time-table'><tr><td><p class='Jcalendar-time-tag'>时</p><p class='hour-add'>+</p><p class='hour-text'>"+e(this.currentHour)+"</p><p class='hour-dec'>-</p></td><td><p class='Jcalendar-time-tag'>分</p><p class='minute-add'>+</p><p class='minute-text'>"+e(this.currentMinute)+"</p><p class='minute-dec'>-</p></td><td><p class='Jcalendar-time-tag'>秒</p><p class='second-add'>+</p><p class='second-text'>"+e(this.currentSecond)+"</p><p class='second-dec'>-</p></td></tr></table></div>":"",h=this.timeSelector?"<p class='Jcalendar-btn-tab'>选择时间</p>":"",v="<div class='Jcalendar-header'><a href='javascript:void(0);' class='Jcalendar-btn-cancel'>取消</a><span class='Jcalendar-title-text'>"+this.title+"</span><a href='javascript:void(0);' class='Jcalendar-btn-sure'>确定</a></div><div class='Jcalendar-body'>"+m+p+"</div><div class='Jcalendar-footer'>"+h+"</div>",g=document.getElementsByClassName("Jcalendar-wrapper")[0];if(i||"object"!=typeof g){var y=document.createElement("div");y.className="Jcalendar-wrapper",y.innerHTML=v;var M=document.createElement("div");M.className="Jcalendar-bg",document.body.appendChild(M),document.body.appendChild(y);var f=setTimeout(function(){M.style.opacity="1",y.className="Jcalendar-wrapper show",clearTimeout(f)},50);this.selectorBindEvent(y,M)}else g.innerHTML=v,this.selectorBindEvent(g,document.getElementsByClassName("Jcalendar-bg")[0])},inputBindEvent:function(){var e=this;this.inputDom.addEventListener("click",function(t){e.currentYear=r(e.inputDom.value).currentYear,e.currentMonth=r(e.inputDom.value).currentMonth,e.currentDay=r(e.inputDom.value).currentDay,e.currentHour=r(e.inputDom.value).currentHour,e.currentMinute=r(e.inputDom.value).currentMinute,e.currentSecond=r(e.inputDom.value).currentSecond,e.render(e.currentYear,e.currentMonth,e.currentDay,e.currentHour,e.currentMinute,e.currentSecond,!0),t.stopPropagation()})},selectorBindEvent:function(r,n){var a=this;r.getElementsByClassName("Jcalendar-btn-sure")[0].addEventListener("click",function(r){!1===a.timeSelector?a.inputDom.value=a.currentYear+"-"+e(a.currentMonth)+"-"+e(a.currentDay):a.inputDom.value=a.currentYear+"-"+e(a.currentMonth)+"-"+e(a.currentDay)+" "+e(a.currentHour)+":"+e(a.currentMinute)+":"+e(a.currentSecond),t(),r.stopPropagation()}),r.getElementsByClassName("Jcalendar-btn-cancel")[0].addEventListener("click",function(e){e.stopPropagation(),t()}),r.getElementsByClassName("Jcalendar-prev-year")[0].addEventListener("click",function(e){a.currentYear>a.startYear&&a.render(a.currentYear-1,a.currentMonth,a.currentDay,a.currentHour,a.currentMinute,a.currentSecond,!1),e.stopPropagation()}),r.getElementsByClassName("Jcalendar-prev-month")[0].addEventListener("click",function(e){a.currentMonth-1==0&&a.currentYear>a.startYear?a.render(a.currentYear-1,12,a.currentDay,a.currentHour,a.currentMinute,a.currentSecond,!1):a.currentMonth-1>0&&a.render(a.currentYear,a.currentMonth-1,a.currentDay,a.currentHour,a.currentMinute,a.currentSecond,!1),e.stopPropagation()}),r.getElementsByClassName("Jcalendar-next-month")[0].addEventListener("click",function(e){a.currentMonth+1>12?a.render(a.currentYear+1,1,a.currentDay,!1):a.render(a.currentYear,a.currentMonth+1,a.currentDay,a.currentHour,a.currentMinute,a.currentSecond,!1),e.stopPropagation()}),r.getElementsByClassName("Jcalendar-next-year")[0].addEventListener("click",function(e){a.render(a.currentYear+1,a.currentMonth,a.currentDay,a.currentHour,a.currentMinute,a.currentSecond,!1),e.stopPropagation()}),r.addEventListener("click",function(e){e.target.className.indexOf("available")>-1&&(a.currentDay=e.target.innerHTML,r.getElementsByClassName("current")[0].className="available",e.target.className="available current",e.stopPropagation())}),!0===a.timeSelector&&(r.getElementsByClassName("Jcalendar-btn-tab")[0].addEventListener("click",function(e){"选择时间"===e.target.innerHTML?(e.target.innerHTML="选择日期",r.getElementsByClassName("Jcalendar-time-wrapper")[0].className="Jcalendar-time-wrapper show"):(e.target.innerHTML="选择时间",r.getElementsByClassName("Jcalendar-time-wrapper")[0].className="Jcalendar-time-wrapper")}),r.getElementsByClassName("hour-add")[0].addEventListener("click",function(t){a.currentHour<23?a.currentHour++:a.currentHour=0,r.getElementsByClassName("hour-text")[0].innerHTML=e(a.currentHour),t.stopPropagation()}),r.getElementsByClassName("hour-dec")[0].addEventListener("click",function(t){a.currentHour>0?a.currentHour--:a.currentHour=23,r.getElementsByClassName("hour-text")[0].innerHTML=e(a.currentHour),t.stopPropagation()}),r.getElementsByClassName("minute-add")[0].addEventListener("click",function(t){a.currentMinute<59?a.currentMinute++:a.currentMinute=0,r.getElementsByClassName("hour-text")[0].innerHTML=e(a.currentHour),r.getElementsByClassName("minute-text")[0].innerHTML=e(a.currentMinute),t.stopPropagation()}),r.getElementsByClassName("minute-dec")[0].addEventListener("click",function(t){a.currentMinute>0?a.currentMinute--:a.currentMinute=59,r.getElementsByClassName("hour-text")[0].innerHTML=e(a.currentHour),r.getElementsByClassName("minute-text")[0].innerHTML=e(a.currentMinute),t.stopPropagation()}),r.getElementsByClassName("second-add")[0].addEventListener("click",function(t){a.currentSecond<59?a.currentSecond++:a.currentSecond=0,r.getElementsByClassName("hour-text")[0].innerHTML=e(a.currentHour),r.getElementsByClassName("minute-text")[0].innerHTML=e(a.currentMinute),r.getElementsByClassName("second-text")[0].innerHTML=e(a.currentSecond),t.stopPropagation()}),r.getElementsByClassName("second-dec")[0].addEventListener("click",function(t){a.currentSecond>0?a.currentSecond--:a.currentSecond=59,r.getElementsByClassName("hour-text")[0].innerHTML=e(a.currentHour),r.getElementsByClassName("minute-text")[0].innerHTML=e(a.currentMinute),r.getElementsByClassName("second-text")[0].innerHTML=e(a.currentSecond),t.stopPropagation()})),n.addEventListener("click",function(){t()})}},a});