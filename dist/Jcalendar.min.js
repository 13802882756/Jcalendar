!function(e,t){function a(e){return e<10?"0"+e:e}function r(){var e=t.getElementsByClassName("Jcalendar-wrapper")[0],a=t.getElementsByClassName("Jcalendar-bg")[0];if("object"==typeof e){e.style.bottom="-100%";var r=setTimeout(function(){e.parentNode.removeChild(e),clearTimeout(r)},300)}if("object"==typeof a){a.style.opacity="0";var n=setTimeout(function(){a.parentNode.removeChild(a),clearTimeout(n)},300)}}function n(e){var t=e.split("-"),a="",r="",n="",c=new Date;if(""===e)a=c.getFullYear(),r=c.getMonth()+1,n=c.getDate();else if(3===t.length){var s=t[0],o=parseInt(t[1]),i=parseInt(t[2]);new Date(s,o,0)>=i&&(a=s,r=o,n=i)}return{currentYear:a,currentMonth:r,currentDay:n}}function c(e,t,a){var r=[],n=new Date;!e|!t|!a&&(e=n.getFullYear(),t=n.getMonth()+1,a=n.getDate());for(var c=new Date(e,t-1,1),s=c.getDay(),o=new Date(e,t,0).getDate(),i=new Date(e,t-1,0).getDate(),l=0;l<s;l++){var u="available disabled",h=i-s+l+1;0===(d=t-1)&&(d=1),r.push({date:h,showDate:h,thisMonth:d,className:u})}for(l=0;l<o;l++){var u="available",d=t;(h=l+1)===a&&(u="available current"),n.getDate()===h&&n.getFullYear()===e&&n.getMonth()+1===t?r.push({date:h,showDate:"今天",thisMonth:d,className:u}):r.push({date:h,showDate:h,thisMonth:d,className:u})}for(var p=r.length,l=0;l<42-p;l++){var u="available disabled",h=l+1;13===(d=t+1)&&(d=12),r.push({date:h,showDate:h,thisMonth:d,className:u})}return{year:c.getFullYear(),month:c.getMonth()+1,days:r}}function s(e){this.inputDom=t.getElementById(e.input),this.currentYear="",this.currentMonth="",this.currentDay="",this.init()}s.prototype={constructor:s,init:function(){this.inputBindEvent()},render:function(e,r,n,s){var o=c(e,r,n),e=o.year,r=o.month,i=o.days;this.currentYear=e,this.currentMonth=r,this.currentDay=n;var l="";i.forEach(function(e,t){t%7==0&&(l+="<tr>"),l+="<td class='"+e.className+"'>"+e.showDate+"</td>",t%7==6&&(l+="<tr>")});var u="<div class='Jcalendar-header'><a class='Jcalendar-prev-year' href='javascript:void(0);'>&lt;&lt;</a><a class='Jcalendar-prev-month' href='javascript:void(0);'>&lt;</a><span class='Jcalendar-year'> "+this.currentYear+"年</span><span class='Jcalendar-month'>"+a(this.currentMonth)+"月 </span><a class='Jcalendar-next-year' href='javascript:void(0);'>&gt;&gt;</a><a class='Jcalendar-next-month' href='javascript:void(0);'>&gt;</a></div><div class='Jcalendar-body'><table class='Jcalendar-table'><thead><tr><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr></thead><tbody>"+l+"</tbody></table></div>",h=t.getElementsByClassName("Jcalendar-wrapper")[0];if(s||"object"!=typeof h){var d=t.createElement("div");d.className="Jcalendar-wrapper",d.innerHTML=u;var p=t.createElement("div");p.className="Jcalendar-bg",t.body.appendChild(p),t.body.appendChild(d);var v=setTimeout(function(){p.style.opacity="1",d.style.bottom="0",clearTimeout(v)},50);this.selectorBindEvent(d,p)}else h.innerHTML=u},inputBindEvent:function(){var e=this;this.inputDom.addEventListener("click",function(t){e.currentYear=n(e.inputDom.value).currentYear,e.currentMonth=n(e.inputDom.value).currentMonth,e.currentDay=n(e.inputDom.value).currentDay,r(),e.render(e.currentYear,e.currentMonth,e.currentDay,!0),t.stopPropagation()})},selectorBindEvent:function(e,t){var n=this;e.addEventListener("click",function(e){n.inputDom.focus(),"Jcalendar-prev-year"===e.target.className?n.render(n.currentYear-1,n.currentMonth,n.currentDay,!1):"Jcalendar-prev-month"===e.target.className?n.render(n.currentYear,n.currentMonth-1,n.currentDay,!1):"Jcalendar-next-month"===e.target.className?n.currentMonth+1>12?n.render(n.currentYear+1,1,n.currentDay):n.render(n.currentYear,n.currentMonth+1,n.currentDay,!1):"Jcalendar-next-year"===e.target.className?n.render(n.currentYear+1,n.currentMonth,n.currentDay,!1):e.target.className.indexOf("available")>-1&&(n.currentDay=e.target.innerHTML,r(),n.inputDom.value=n.currentYear+"-"+a(n.currentMonth)+"-"+a(n.currentDay)),e.stopPropagation()}),t.addEventListener("click",function(){r()})}},"object"==typeof exports?module.exports=s:"function"==typeof define&&define.amd?define([],function(){return s}):e.Jcalendar=s}(window,document);